<template>
    <div class="flex flex-row justify-center items-center  p-2 w-full rounded-lg">
        <div class="flex w-full items-center gap-1.5">
            <Input type="text" id="search" placeholder="Search" v-model="word" class="bg-[#EAEAEA]" />
        </div>
        <div class="mx-2">
            <Popover>
                <PopoverTrigger as-child>
                    <Button class="bg-[#EAEAEA]">
                        <SVG :color="'#646464'"
                            :d="'M7.2001 1.6001C7.41227 1.6001 7.61575 1.68438 7.76578 1.83441C7.91581 1.98444 8.0001 2.18792 8.0001 2.4001V3.2001H16.0001V2.4001C16.0001 2.18792 16.0844 1.98444 16.2344 1.83441C16.3844 1.68438 16.5879 1.6001 16.8001 1.6001C17.0123 1.6001 17.2158 1.68438 17.3658 1.83441C17.5158 1.98444 17.6001 2.18792 17.6001 2.4001V3.2001H20.0001C20.6366 3.2001 21.2471 3.45295 21.6972 3.90304C22.1472 4.35313 22.4001 4.96358 22.4001 5.6001V20.0001C22.4001 20.6366 22.1472 21.2471 21.6972 21.6972C21.2471 22.1472 20.6366 22.4001 20.0001 22.4001H4.0001C3.36358 22.4001 2.75313 22.1472 2.30304 21.6972C1.85295 21.2471 1.6001 20.6366 1.6001 20.0001V5.6001C1.6001 4.96358 1.85295 4.35313 2.30304 3.90304C2.75313 3.45295 3.36358 3.2001 4.0001 3.2001H6.4001V2.4001C6.4001 2.18792 6.48438 1.98444 6.63441 1.83441C6.78444 1.68438 6.98792 1.6001 7.2001 1.6001ZM16.0001 4.8001V5.6001C16.0001 5.81227 16.0844 6.01575 16.2344 6.16578C16.3844 6.31581 16.5879 6.4001 16.8001 6.4001C17.0123 6.4001 17.2158 6.31581 17.3658 6.16578C17.5158 6.01575 17.6001 5.81227 17.6001 5.6001V4.8001H20.0001C20.2123 4.8001 20.4158 4.88438 20.5658 5.03441C20.7158 5.18444 20.8001 5.38792 20.8001 5.6001V8.0001H3.2001V5.6001C3.2001 5.38792 3.28438 5.18444 3.43441 5.03441C3.58444 4.88438 3.78792 4.8001 4.0001 4.8001H6.4001V5.6001C6.4001 5.81227 6.48438 6.01575 6.63441 6.16578C6.78444 6.31581 6.98792 6.4001 7.2001 6.4001C7.41227 6.4001 7.61575 6.31581 7.76578 6.16578C7.91581 6.01575 8.0001 5.81227 8.0001 5.6001V4.8001H16.0001ZM3.2001 9.6001V20.0001C3.2001 20.2123 3.28438 20.4158 3.43441 20.5658C3.58444 20.7158 3.78792 20.8001 4.0001 20.8001H20.0001C20.2123 20.8001 20.4158 20.7158 20.5658 20.5658C20.7158 20.4158 20.8001 20.2123 20.8001 20.0001V9.6001H3.2001ZM11.2001 12.0001C11.2001 11.7879 11.2844 11.5844 11.4344 11.4344C11.5844 11.2844 11.7879 11.2001 12.0001 11.2001C12.2123 11.2001 12.4158 11.2844 12.5658 11.4344C12.7158 11.5844 12.8001 11.7879 12.8001 12.0001C12.8001 12.2123 12.7158 12.4158 12.5658 12.5658C12.4158 12.7158 12.2123 12.8001 12.0001 12.8001C11.7879 12.8001 11.5844 12.7158 11.4344 12.5658C11.2844 12.4158 11.2001 12.2123 11.2001 12.0001ZM15.2001 11.2001C14.9879 11.2001 14.7844 11.2844 14.6344 11.4344C14.4844 11.5844 14.4001 11.7879 14.4001 12.0001C14.4001 12.2123 14.4844 12.4158 14.6344 12.5658C14.7844 12.7158 14.9879 12.8001 15.2001 12.8001C15.4123 12.8001 15.6158 12.7158 15.7658 12.5658C15.9158 12.4158 16.0001 12.2123 16.0001 12.0001C16.0001 11.7879 15.9158 11.5844 15.7658 11.4344C15.6158 11.2844 15.4123 11.2001 15.2001 11.2001ZM17.6001 12.0001C17.6001 11.7879 17.6844 11.5844 17.8344 11.4344C17.9844 11.2844 18.1879 11.2001 18.4001 11.2001C18.6123 11.2001 18.8158 11.2844 18.9658 11.4344C19.1158 11.5844 19.2001 11.7879 19.2001 12.0001C19.2001 12.2123 19.1158 12.4158 18.9658 12.5658C18.8158 12.7158 18.6123 12.8001 18.4001 12.8001C18.1879 12.8001 17.9844 12.7158 17.8344 12.5658C17.6844 12.4158 17.6001 12.2123 17.6001 12.0001ZM18.4001 14.4001C18.1879 14.4001 17.9844 14.4844 17.8344 14.6344C17.6844 14.7844 17.6001 14.9879 17.6001 15.2001C17.6001 15.4123 17.6844 15.6158 17.8344 15.7658C17.9844 15.9158 18.1879 16.0001 18.4001 16.0001C18.6123 16.0001 18.8158 15.9158 18.9658 15.7658C19.1158 15.6158 19.2001 15.4123 19.2001 15.2001C19.2001 14.9879 19.1158 14.7844 18.9658 14.6344C18.8158 14.4844 18.6123 14.4001 18.4001 14.4001ZM14.4001 15.2001C14.4001 14.9879 14.4844 14.7844 14.6344 14.6344C14.7844 14.4844 14.9879 14.4001 15.2001 14.4001C15.4123 14.4001 15.6158 14.4844 15.7658 14.6344C15.9158 14.7844 16.0001 14.9879 16.0001 15.2001C16.0001 15.4123 15.9158 15.6158 15.7658 15.7658C15.6158 15.9158 15.4123 16.0001 15.2001 16.0001C14.9879 16.0001 14.7844 15.9158 14.6344 15.7658C14.4844 15.6158 14.4001 15.4123 14.4001 15.2001ZM12.0001 14.4001C11.7879 14.4001 11.5844 14.4844 11.4344 14.6344C11.2844 14.7844 11.2001 14.9879 11.2001 15.2001C11.2001 15.4123 11.2844 15.6158 11.4344 15.7658C11.5844 15.9158 11.7879 16.0001 12.0001 16.0001C12.2123 16.0001 12.4158 15.9158 12.5658 15.7658C12.7158 15.6158 12.8001 15.4123 12.8001 15.2001C12.8001 14.9879 12.7158 14.7844 12.5658 14.6344C12.4158 14.4844 12.2123 14.4001 12.0001 14.4001ZM8.0001 15.2001C8.0001 14.9879 8.08438 14.7844 8.23441 14.6344C8.38444 14.4844 8.58792 14.4001 8.8001 14.4001C9.01227 14.4001 9.21575 14.4844 9.36578 14.6344C9.51581 14.7844 9.6001 14.9879 9.6001 15.2001C9.6001 15.4123 9.51581 15.6158 9.36578 15.7658C9.21575 15.9158 9.01227 16.0001 8.8001 16.0001C8.58792 16.0001 8.38444 15.9158 8.23441 15.7658C8.08438 15.6158 8.0001 15.4123 8.0001 15.2001ZM5.6001 14.4001C5.38792 14.4001 5.18444 14.4844 5.03441 14.6344C4.88438 14.7844 4.8001 14.9879 4.8001 15.2001C4.8001 15.4123 4.88438 15.6158 5.03441 15.7658C5.18444 15.9158 5.38792 16.0001 5.6001 16.0001C5.81227 16.0001 6.01575 15.9158 6.16578 15.7658C6.31581 15.6158 6.4001 15.4123 6.4001 15.2001C6.4001 14.9879 6.31581 14.7844 6.16578 14.6344C6.01575 14.4844 5.81227 14.4001 5.6001 14.4001ZM4.8001 18.4001C4.8001 18.1879 4.88438 17.9844 5.03441 17.8344C5.18444 17.6844 5.38792 17.6001 5.6001 17.6001C5.81227 17.6001 6.01575 17.6844 6.16578 17.8344C6.31581 17.9844 6.4001 18.1879 6.4001 18.4001C6.4001 18.6123 6.31581 18.8158 6.16578 18.9658C6.01575 19.1158 5.81227 19.2001 5.6001 19.2001C5.38792 19.2001 5.18444 19.1158 5.03441 18.9658C4.88438 18.8158 4.8001 18.6123 4.8001 18.4001ZM8.8001 17.6001C8.58792 17.6001 8.38444 17.6844 8.23441 17.8344C8.08438 17.9844 8.0001 18.1879 8.0001 18.4001C8.0001 18.6123 8.08438 18.8158 8.23441 18.9658C8.38444 19.1158 8.58792 19.2001 8.8001 19.2001C9.01227 19.2001 9.21575 19.1158 9.36578 18.9658C9.51581 18.8158 9.6001 18.6123 9.6001 18.4001C9.6001 18.1879 9.51581 17.9844 9.36578 17.8344C9.21575 17.6844 9.01227 17.6001 8.8001 17.6001ZM11.2001 18.4001C11.2001 18.1879 11.2844 17.9844 11.4344 17.8344C11.5844 17.6844 11.7879 17.6001 12.0001 17.6001C12.2123 17.6001 12.4158 17.6844 12.5658 17.8344C12.7158 17.9844 12.8001 18.1879 12.8001 18.4001C12.8001 18.6123 12.7158 18.8158 12.5658 18.9658C12.4158 19.1158 12.2123 19.2001 12.0001 19.2001C11.7879 19.2001 11.5844 19.1158 11.4344 18.9658C11.2844 18.8158 11.2001 18.6123 11.2001 18.4001ZM15.2001 17.6001C14.9879 17.6001 14.7844 17.6844 14.6344 17.8344C14.4844 17.9844 14.4001 18.1879 14.4001 18.4001C14.4001 18.6123 14.4844 18.8158 14.6344 18.9658C14.7844 19.1158 14.9879 19.2001 15.2001 19.2001C15.4123 19.2001 15.6158 19.1158 15.7658 18.9658C15.9158 18.8158 16.0001 18.6123 16.0001 18.4001C16.0001 18.1879 15.9158 17.9844 15.7658 17.8344C15.6158 17.6844 15.4123 17.6001 15.2001 17.6001Z'"></SVG>
                    </Button>
                </PopoverTrigger>
                <PopoverContent class="w-auto p-0">
                    <RangeCalendar v-model="value" class="rounded-md border" :locale="'kz'" :style="'bg-red-400'" />
                </PopoverContent>
            </Popover>
        </div>
    </div>
</template>

<script setup lang="ts">
import { ref, watchEffect, onMounted } from 'vue';
import { Input } from '@/components/ui/input';
import { useStorage } from '~/state';
import { type Organization } from '../formReports/index.vue';
import { type Ref } from 'vue'
import {
    CalendarDate,
    DateFormatter,
    getLocalTimeZone, today
} from '@internationalized/date';
import { Calendar as CalendarIcon } from 'lucide-vue-next';
import type { DateRange } from 'radix-vue';
import { RangeCalendar } from '@/components/ui/range-calendar';
import { Button } from '@/components/ui/button'
import { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';
import SVG from '../ui/svg/SVG.vue';


const df = new DateFormatter('en-US', {
    dateStyle: 'medium',
})

const state = useStorage();
const listOrg = ref<Organization[]>([]);
const loading = ref<boolean>(true);
const selectedValue = ref<string>('');
const word = ref<string>('');
const start = today(getLocalTimeZone())
const end = start.add({ days: 7 })

const postFilter = () => {
    console.log('Selected value:', selectedValue.value);
    if (selectedValue.value !== '') {
        state.filterReport(selectedValue.value);
    }
};

const postSeatch = () => {
    if (word.value !== '') {
        state.search(word.value);
    }
};

const search = (text: string) => {
    if (text.trim() === '') {
        console.log('Input empty!')
    }
    else {
        state.searchDescription(text);
    }
}
const currentDate = new Date();

const value = ref({
    start,
    end,
}) as Ref<DateRange>

watch(value, () => {
    console.log(value.value)
})

watchEffect(() => {
    const allOrganization = state.$state.AllOrganization;
    if (allOrganization) {
        listOrg.value = allOrganization.List;
        loading.value = allOrganization.loading;
    }
});

onMounted(() => {
    state.getAllOrganization();
});
</script>
